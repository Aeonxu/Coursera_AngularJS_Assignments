<!DOCTYPE html>
<html lang="en" ng-app="MenuApp">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Restaurant Menu App</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header class="app-header">
      <h1>Golden Gate of Shanghai Restaurant</h1>
    </header>
    
    <nav class="main-nav">
      <a ui-sref="home">Home</a>
      <a ui-sref="categories">Menu Categories</a>
    </nav>

    <main class="main-content">
      <ui-view></ui-view>
    </main>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
  <script src="https://unpkg.com/@uirouter/angularjs@1.0.20/release/angular-ui-router.min.js"></script>

  <!-- Component Templates -->
  <script type="text/ng-template" id="categories.template.html">
    <div class="categories-view">
      <h2>Menu Categories</h2>
      <div ng-if="!$ctrl.categories" class="loading">Loading categories...</div>
      <div ng-if="$ctrl.categories && $ctrl.categories.length === 0" class="error">
        No categories found.
      </div>
      <ul class="categories-list" ng-if="$ctrl.categories && $ctrl.categories.length > 0">
        <li class="category-item" ng-repeat="category in $ctrl.categories">
          <a ui-sref="items({categoryShortName: category.short_name})" class="category-link">
            {{ category.name }}
          </a>
          <div ng-if="category.special_instructions" class="category-description">
            {{ category.special_instructions }}
          </div>
        </li>
      </ul>
    </div>
  </script>

  <script type="text/ng-template" id="items.template.html">
    <div class="items-view">
      <h2>Menu Items - {{ $ctrl.items.category.name }}</h2>
      <div class="nav-back">
        <a ui-sref="categories">‚Üê Back to Categories</a>
      </div>
      <div ng-if="!$ctrl.items" class="loading">Loading menu items...</div>
      <div ng-if="$ctrl.items && (!$ctrl.items.menu_items || $ctrl.items.menu_items.length === 0)" class="error">
        No menu items found for this category.
      </div>
      <ul class="items-list" ng-if="$ctrl.items && $ctrl.items.menu_items && $ctrl.items.menu_items.length > 0">
        <li class="item-card" ng-repeat="item in $ctrl.items.menu_items">
          <div class="item-header">
            <span class="item-name">{{ item.name }}</span>
            <span class="item-code">{{ item.short_name }}</span>
          </div>
          <div class="item-description">{{ item.description }}</div>
          <div class="item-price">${{ item.price_large || item.price_small || 'Market Price' }}</div>
        </li>
      </ul>
    </div>
  </script>

  <!-- Application JavaScript -->
  <script>
    // menuapp.module.js
    (function() {
      'use strict';
      angular.module('MenuApp', ['ui.router', 'data']);
    })();

    // data.module.js
    (function() {
      'use strict';
      angular.module('data', []);
    })();

    // menudata.service.js
    (function() {
      'use strict';
      angular.module('data')
      .service('MenuDataService', MenuDataService);
      
      MenuDataService.$inject = ['$http'];
      function MenuDataService($http) {
        var service = this;
        
        service.getAllCategories = function() {
          return $http({
            method: 'GET',
            url: 'https://coursera-jhu-default-rtdb.firebaseio.com/categories.json'
          }).then(function(response) {
            return response.data;
          });
        };
        
        service.getItemsForCategory = function(categoryShortName) {
          return $http({
            method: 'GET',
            url: 'https://coursera-jhu-default-rtdb.firebaseio.com/menu_items/' + categoryShortName + '.json'
          }).then(function(response) {
            return response.data;
          });
        };
      }
    })();

    // categories.component.js
    (function() {
      'use strict';
      angular.module('MenuApp')
      .component('categories', {
        templateUrl: 'categories.template.html',
        bindings: {
          categories: '<'
        }
      });
    })();

    // items.component.js
    (function() {
      'use strict';
      angular.module('MenuApp')
      .component('items', {
        templateUrl: 'items.template.html',
        bindings: {
          items: '<'
        }
      });
    })();

    // routes.js
    (function() {
      'use strict';
      angular.module('MenuApp')
      .config(RoutesConfig);
      
      RoutesConfig.$inject = ['$stateProvider', '$urlRouterProvider'];
      function RoutesConfig($stateProvider, $urlRouterProvider) {
        
        $urlRouterProvider.otherwise('/');
        
        $stateProvider
        .state('home', {
          url: '/',
          template: `
            <div class="home-view">
              <h2>Welcome to Golden Dragon</h2>
              <p>Experience authentic Chinese cuisine made with fresh ingredients and traditional recipes.</p>
              <p><a ui-sref="categories" class="cta-link">View our menu categories</a> to explore our offerings.</p>
            </div>
          `
        })
        .state('categories', {
          url: '/categories',
          template: '<categories categories="$resolve.categories"></categories>',
          resolve: {
            categories: ['MenuDataService', function(MenuDataService) {
              return MenuDataService.getAllCategories();
            }]
          }
        })
        .state('items', {
          url: '/items/{categoryShortName}',
          template: '<items items="$resolve.items"></items>',
          resolve: {
            items: ['$stateParams', 'MenuDataService', function($stateParams, MenuDataService) {
              return MenuDataService.getItemsForCategory($stateParams.categoryShortName);
            }]
          }
        });
      }
    })();
  </script>
</body>
</html>